<div class="container shopping-cart">
  <div class="col-md-12">

    <h2 class="cartH2">Your Shopping Cart</h2>

    <!-- Default bootstrap modal example -->
    <div class="modal text-center fade" id="cartModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div id="addAddressModal" class="modal-content text-center col-md-12">
            <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel">Add Address</h4>
          </div>
          <div class="modal-body col-md-12">
             <br>
            <form action="/users/address/{{user}}"  method="POST" class="text-left col-md-offset-2 col-md-12">
            <fieldset>
            <!-- Text input-->
            <div class="form-group">
            <label class="col-md-4 control-label">STREET 1</label>
            <input name="street1" type="text" value"" class="form-control">
            <label class="col-md-4 control-label">STREET 2</label>
            <input name="street2" type="text" value="" class="form-control">
            <label class="col-md-4 control-label">CITY</label>
            <input name="city" type="text" value="" class="form-control">
            <label class="col-md-4 control-label">STATE</label>
            <input name="state" type="text" value="" class="form-control">
            <label class="col-md-4 control-label">ZIP</label>
            <input name="zipcode" type="text" value="" class="form-control">
            <br>
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
            <input class="btn btn-defualt" type="submit"  value="SAVE ADDRESS">
            </div>
            </fieldset>
            </form>
            </div>
            <div class="modal-footer">

          </div>

            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>

        </div>
      </div>
    </div>
    <table class="cartTable">
      <tr>
        <th></th>
        <th>Item</th>
        <th>Description</th>
        <th>Price</th>
      </tr>
      {{#data}}
      <tr>
        <td><img style="height: 100px;" src="{{this.image_url}}"/></td>
        <td>{{this.name}}</td>
        <td>{{this.description}}</td>
        <td class="price" price-data={{this.price}}>${{this.price}}</td>
        <td><a class='btn btn-danger deleteItem' data-item-id="{{this.item_id}}" href="#">Delete this item</a></td>
      </tr>
      {{/data}}
    </table>
    <div class="taxTotal">
      <br>
      <span class='totals'><h4>Tax:</h4><h4 class="tax"></h4></span>
      <br>
      <span class='totals'><h3>Total:</h3><h3 class="total"></h3></span>
    </div>
  </div>

  {{#msg}}
  <h4 class='address-message'>{{this}}</h4>
  {{/msg}}
  <!-- Modal Remote -->
  <a class="address btn btn-primary" href="remoteContent.html" data-remote="false" data-toggle="modal" data-target="#cartModal">
      Add Address
  </a>

<div class="payment">
    <form action="/users/cart/payment" method="POST">
    <script
      src="https://checkout.stripe.com/checkout.js" class="stripe-button"
      data-key="pk_test_8sP6vahxQVW8aN5FlAlYJXmF"
      data-amount="{{amount}}"
      data-name="Basket"
      data-description="Thank you!"
      data-image=""
      data-locale="auto">
    </script>
  </form>
</div>


<script type="text/javascript">
  $('.deleteItem').on('click', function (event) {
    event.preventDefault();

    var itemId = $(this).data('item-id');

    $.ajax({
      url: '/users/cart/' + itemId,
      type: 'DELETE',
      success: function (result){
        if(result){
          window.location='/users/cart';
        }
      }
    })
  });
</script>
